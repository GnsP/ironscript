(function(){function A(b,d){if(!b)throw console.log(d),Error(d);}function R(b){return b}function wa(b,d,a){switch(a.length){case 0:return b.call(d);case 1:return b.call(d,a[0]);case 2:return b.call(d,a[0],a[1]);case 3:return b.call(d,a[0],a[1],a[2])}return b.apply(d,a)}function xa(b,d,a){d=S(void 0===d?b.length-1:d,0);return function(){for(var c=arguments,e=-1,g=S(c.length-d,0),f=Array(g);++e<g;)f[e]=c[d+e];e=-1;for(g=Array(d+1);++e<d;)g[e]=c[e];g[d]=a(f);return wa(b,this,g)}}function ya(b){return function(){return b}}
function F(b){if(null==b)return void 0===b?"[object Undefined]":"[object Null]";b=Object(b);var d;if(T&&T in b){var a=za.call(b,z),c=b[z];try{b[z]=void 0,d=!0}catch(g){}var e=Aa.call(b);d&&(a?b[z]=c:delete b[z]);d=e}else d=Ba.call(b);return d}function U(b){var d=typeof b;return null!=b&&("object"==d||"function"==d)}function V(b){if(!U(b))return!1;b=F(b);return"[object Function]"==b||"[object GeneratorFunction]"==b||"[object AsyncFunction]"==b||"[object Proxy]"==b}function Ca(b){if(null!=b){try{return Da.call(b)}catch(d){}return b+
""}return""}function t(b,d){return Ea(xa(b,d,R),b+"")}function W(b){return t(function(d,a){var c=X(function(a,c){var e=this;return b(d,function(c,b){c.apply(e,a.concat([b]))},c)});return a.length?c.apply(this,a):c})}function Y(b){return"number"==typeof b&&-1<b&&0==b%1&&9007199254740991>=b}function G(b){return null!=b&&Y(b.length)&&!V(b)}function x(){}function B(b){return function(){if(null!==b){var d=b;b=null;d.apply(this,arguments)}}}function H(b){return null!=b&&"object"==typeof b}function Z(b){return H(b)&&
"[object Arguments]"==F(b)}function Fa(){return!1}function Ga(b){return H(b)&&Y(b.length)&&!!n[F(b)]}function Ha(b){return function(d){return b(d)}}function Ia(b){if(G(b)){var d=Ja(b),a=!d&&Ka(b),c=!d&&!a&&La(b),e=!d&&!a&&!c&&Ma(b);if(d=d||a||c||e){for(var a=b.length,g=String,f=-1,k=Array(a);++f<a;)k[f]=g(f);a=k}else a=[];var g=a.length,l;for(l in b)(f=!Na.call(b,l))||!(f=d)||(f="length"==l||c&&("offset"==l||"parent"==l)||e&&("buffer"==l||"byteLength"==l||"byteOffset"==l))||(f=l,k=g,k=null==k?9007199254740991:
k,f=!!k&&("number"==typeof f||Oa.test(f))&&-1<f&&0==f%1&&f<k),f||a.push(l);b=a}else if(l=b&&b.constructor,b===("function"==typeof l&&l.prototype||Pa)){l=[];for(c in Object(b))Qa.call(b,c)&&"constructor"!=c&&l.push(c);b=l}else b=Ra(b);return b}function Sa(b){var d=-1,a=b.length;return function(){return++d<a?{value:b[d],key:d}:null}}function Ta(b){var d=-1;return function(){var a=b.next();if(a.done)return null;d++;return{value:a.value,key:d}}}function Ua(b){var d=Ia(b),a=-1,c=d.length;return function(){var e=
d[++a];return a<c?{value:b[e],key:e}:null}}function Va(b){if(G(b))return Sa(b);var d=I&&b[I]&&b[I]();return d?Ta(d):Ua(b)}function J(b){return function(){if(null===b)throw Error("Callback was already called.");var d=b;b=null;d.apply(this,arguments)}}function aa(b){return function(d,a,c){function e(a,b){--l;if(a)k=!0,c(a);else{if(b===Wa||k&&0>=l)return k=!0,c(null);g()}}function g(){for(;l<b&&!k;){var d=f();if(null===d){k=!0;0>=l&&c(null);break}l+=1;a(d.value,d.key,J(e))}}c=B(c||x);if(0>=b||!d)return c(null);
var f=Va(d),k=!1,l=0;g()}}function ba(b,d,a,c){aa(d)(b,a,c)}function K(b,d){return function(a,c,e){return b(a,d,c,e)}}function Xa(b,d,a){function c(c){c?a(c):++g===f&&a(null)}a=B(a||x);var e=0,g=0,f=b.length;for(0===f&&a(null);e<f;e++)d(b[e],e,J(c))}function ca(b,d,a,c){c=B(c||x);d=d||[];var e=[],g=0;b(d,function(c,b,d){var f=g++;a(c,function(a,c){e[f]=c;d(a)})},function(a){c(a,e)})}function Ya(b,d){for(var a=-1,c=null==b?0:b.length;++a<c&&!1!==d(b[a],a,b););return b}function da(b){setTimeout(b,0)}
function ea(b){return t(function(d,a){b(function(){d.apply(null,a)})})}function v(){this.head=this.tail=null;this.length=0}function Za(b,d,a,c){c=B(c||x);$a(b,function(c,b,f){a(d,c,function(a,c){d=c;f(a)})},function(a){c(a,d)})}function fa(b){return t(function(d,a){d.apply(null,a.concat([t(function(a,d){"object"===typeof console&&(a?console.error&&console.error(a):console[b]&&Ya(d,function(a){console[b](a)}))})]))})}function ab(b,d,a){a=J(a||x);if(!b())return a(null);var c=t(function(e,g){if(e)return a(e);
if(b())return d(c);a.apply(null,[null].concat(g))});d(c)}function p(b,d){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:bb;b instanceof m?cb.equal(b)?h(a,null,d,null,d):db.equal(b)?h(a,null,d,null,null):eb.equal(b)?h(a,null,d,null,{}):fb.equal(b)?h(a,null,d,null,[]):gb.equal(b)?h(a,null,d,null,new Map):h(a,null,d,null,d.get(b)):b instanceof q?hb.equal(b.car)?h(a,null,d,null,b.cdr.car):ib.equal(b.car)?function(){var c=b.cdr.cdr.car,e=b.cdr.cdr.cdr.car;h(p,b.cdr.car,d,function(b,d,k,l){h(p,
l?c:e,d,a)})}():jb.equal(b.car)?function(){var c=b.cdr.car;h(p,b.cdr.cdr.car,d,function(b,g,f,k){d.bind(c,k)?h(a,null,d,null,!0):h(a,"can _def only inside a _begin block")})}():kb.equal(b.car)?function(){var c=b.cdr.car;h(p,b.cdr.cdr.car,d,function(b,g,f,k){d.find(c).bind(c,k)?h(a,null,d,null,!0):h(a,"can _def only inside a _begin block")})}():lb.equal(b.car)?function(){var c=b.cdr.cdr.car;h(p,b.cdr.car,d,function(b,g,f,k){h(p,c,d,function(c,b,e,f){k instanceof Object&&"env"===k.__itype__?f instanceof
Object&&"ironsymbol"===f.type?h(a,c,d,null,k.map.get(f.symbol)):h(a,c,d,null,f):k instanceof Map?h(a,c,d,null,k.get(f)):k instanceof Array?h(a,c,d,null,k[f]):k instanceof Object?f instanceof Object&&"ironsymbol"===f.type?h(a,c,d,null,k[f.symbol]):h(a,c,d,null,k[f]):h(a,new r("Can not _get from "+k))})})}():mb.equal(b.car)?function(){var c=b.cdr.cdr.car;h(p,b.cdr.car,d,function(b,g,f,k){h(p,c,d,function(b,e,f,g){h(p,c,d,function(c,b,e,f){c=g;if(k instanceof Object&&"env"===k.__itype__)h(a,new r("can not set to a scope outside the scope"));
else if(k instanceof Map)h(a,null,d,null,k.set(c,f));else if(k instanceof Array)if(isNaN(Number(c)))h(a,new r("Arrays can have integers as keys"));else{var l=Number(l);0===l%1?(0>l&&(l=k.length+l),0>l&&h(a,new r("can not _set "+k+" ["+(l-k.length)+"]")),k[l]=f,h(a,null,d,null,k)):h(a,new r("Arrays can have integers as keys"))}else k instanceof Object?(c instanceof Object&&"ironsymbol"===c.type&&(c=c.symbol),k[c]=f,h(a,null,d,null,k)):h(a,new r("Can not _set on "+k))})})})}():ob.equal(b.car)?function(){var c=
b.cdr.cdr.car;h(p,b.cdr.car,d,function(b,g,f,k){h(p,c,d,function(c,b,e,f){k instanceof Array?(k.push(f),h(a,null,d,null,k)):h(a,new r("Can _push only on Arrays"))})})}():pb.equal(b.car)?h(a,null,d,null,qb(b.cdr.car,b.cdr.cdr.car,d)):rb.equal(b.car)?function(){var c=b.cdr.cdr.car;h(p,b.cdr.car,d,function(b,g,f,k){b=d.rho.accept(k,c);b instanceof r?h(a,b):h(a,null,d,null,d)})}():sb.equal(b.car)?function(){var c=new y(null,null,d);c.sync();ab(function(){return b.cdr instanceof q},function(a){b=b.cdr;
h(p,b.car,c,function(c,b,d,e){h(a,c,e)})},function(b,d){c.unsync();h(a,b,c,null,d)})}():tb.equal(b.car)?function(){for(var c=b.cdr.car,e=b.cdr.cdr,g=[],f=[];e instanceof q;)g.push(void 0),f.push(e.car),e=e.cdr;h(p,c,d,function(c,b,e,m){h(a,c,d,null,function(a,c,b,e){a=function(a){h(p,f[a],d,function(c,e,f,k){g[a]=k;h.apply(void 0,[m,c,d,b].concat(g))})};for(c=0;c<f.length;c++)a(c)})})}():ub.equal(b.car)?(h(p,b.cdr.car,d,function(a,b,g,f){h(f,a,d,function(a){if(a)throw a;})}),h(a,null,d,null,null)):
h(p,b.car,d,function(c,d,g,f){if(f instanceof Object&&"env"===f.__itype__)(function(){var c=b.cdr,e=new y(null,null,d),g=f.rho.reduce(c,e);null===g?h(a,null,e,null,null):function(){var c=g.params,b=g.body;M(g.args,32,function(a,c){h(p,a,e,function(a,b,d,e){h(c,a,e)})},function(d,f){var g=new y(q.list(c),q.list(f),e);h(p,b,g,function(c,b,d,f){h(a,c,e,null,f)})})}()})();else if(f instanceof Function){for(c=[];b.cdr instanceof q;)b=b.cdr,c.push(b.car);M(c,32,function(a,c){h(p,a,d,function(a,b,d,e){h(c,
a,e)})},function(c,b){var e=new y(null,null,d);h.apply(void 0,[f,c,e,a].concat(vb(b)))})}else h(a,new r("can not evaluate list "+b))}):h(a,null,d,null,b)}function qb(b,d,a){return function(c,e,g){c&&g(c);for(var f=arguments.length,k=Array(3<f?f-3:0),l=3;l<f;l++)k[l-3]=arguments[l];h(p,d,new y(b,q.list(k),a),g)}}function wb(b,d,a,c){b&&a(b);h(a,null,d,null,function(a,b,d){for(var e=arguments.length,f=Array(3<e?e-3:0),g=3;g<e;g++)f[g-3]=arguments[g];e=c.apply(void 0,f);h(d,null,b,null,e)})}function ga(b){return function(d,
a,c){for(var e=arguments.length,g=Array(3<e?e-3:0),f=3;f<e;f++)g[f-3]=arguments[f];e=b.apply(void 0,g);h(c,null,a,null,e)}}function xb(b){return function(d,a,c){for(var e=arguments.length,g=Array(3<e?e-3:0),f=3;f<e;f++)g[f-3]=arguments[f];var k=!1;h.apply(void 0,[b,function(b){k||(h(c,null,a,null,b),k=!0)},function(b){k||(h(c,b,a,null,null),k=!0)},function(a,c){d instanceof a&&c()},function(b){h(c,null,a,null,b)},a].concat(g))}}function yb(b,d,a,c,e){e||(e="unnamed");b=new N({name:e,buffer:c});h(p,
b.parse(),ha(),function(c,b,e,l){a&&h(a,c,d,null,b)})}function zb(){for(var b=arguments.length,d=Array(b),a=0;a<b;a++)d[a]=arguments[a];var b=!0,a=!1,c=void 0;try{for(var e=d[Symbol.iterator](),g;!(b=(g=e.next()).done);b=!0){var f=g.value;f instanceof q?console.log(q.printList(f)):console.log(f)}}catch(k){a=!0,c=k}finally{try{!b&&e["return"]&&e["return"]()}finally{if(a)throw c;}}}(function(){function b(a){this.value=a}function d(a){function c(e,f){try{var g=a[e](f),k=g.value;k instanceof b?Promise.resolve(k.value).then(function(a){c("next",
a)},function(a){c("throw",a)}):d(g.done?"return":"normal",g.value)}catch(L){d("throw",L)}}function d(a,b){switch(a){case "return":g.resolve({value:b,done:!0});break;case "throw":g.reject(b);break;default:g.resolve({value:b,done:!1})}(g=g.next)?c(g.key,g.arg):f=null}var g,f;this._invoke=function(a,b){return new Promise(function(d,e){var k={key:a,arg:b,resolve:d,reject:e,next:null};f?f=f.next=k:(g=f=k,c(a,b))})};"function"!==typeof a["return"]&&(this["return"]=void 0)}"function"===typeof Symbol&&Symbol.asyncIterator&&
(d.prototype[Symbol.asyncIterator]=function(){return this});d.prototype.next=function(a){return this._invoke("next",a)};d.prototype["throw"]=function(a){return this._invoke("throw",a)};d.prototype["return"]=function(a){return this._invoke("return",a)};return{wrap:function(a){return function(){return new d(a.apply(this,arguments))}},await:function(a){return new b(a)}}})();var u=function(b,d){if(!(b instanceof d))throw new TypeError("Cannot call a class as a function");},w=function(){function b(b,a){for(var c=
0;c<a.length;c++){var d=a[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(d,a,c){a&&b(d.prototype,a);c&&b(d,c);return d}}(),vb=function(b){if(Array.isArray(b)){for(var d=0,a=Array(b.length);d<b.length;d++)a[d]=b[d];return a}return Array.from(b)},q=function(){function b(d){u(this,b);this.car=d;this.cdr=null}w(b,null,[{key:"cons",value:function(d,a){var c=new b(d);c.cdr=a;return c}},{key:"list",value:function(d){var a=
null,c=!1,e=void 0,g=!0,f=!1,k=void 0;try{for(var h=d[Symbol.iterator](),m;!(g=(m=h.next()).done);g=!0){var n=m.value;c?(e.cdr=new b(n),e=e.cdr):(a=new b(n),c=!0,e=a)}}catch(L){f=!0,k=L}finally{try{!g&&h["return"]&&h["return"]()}finally{if(f)throw k;}}return a}},{key:"printList",value:function(d){for(var a="( ";null!=d.cdr;)a+=b.printAtom(d.car),a+=" ",d=d.cdr;a+=b.printAtom(d.car);return a+" ) "}},{key:"printAtom",value:function(d){return d instanceof b?b.printList(d):d instanceof Object&&"ironsymbol"===
d.type?d.symbol:""+d}}]);return b}(),m=function(){function b(d){u(this,b);this.symbol=d;this.type="ironsymbol"}w(b,[{key:"equal",value:function(d){return!d instanceof b?!1:d.symbol===this.symbol}},{key:"startsWith",value:function(b){return this.symbol.startsWith(b)}}]);return b}(),r=function(){function b(d){u(this,b);this.message=d}w(b,[{key:"log",value:function(){console.log(this.message)}}]);return b}(),O=new m("__internal (any)"),Ab=function(){function b(){u(this,b);this.table=new Map;this.finalPointer=
null}w(b,[{key:"accept",value:function(d,a){if(d instanceof q)return new r("[RHO INTERNAL] Expected an atomic value; got a LIST: "+d);var c=d;d.startsWith("@")&&(a.push(d),c=O);this.table.has(c.symbol)||this.table.set(c.symbol,new b);return this.table.get(c.symbol)}},{key:"find",value:function(b,a){return this.table.has(b.symbol)?this.table.get(b.symbol):this.table.has(O.symbol)?(a.push(b),this.table.get(O.symbol)):null}},{key:"makeFinal",value:function(b){this.finalPointer=b}}]);return b}(),Bb=function d(a,
c){u(this,d);this.params=a;this.body=c},Cb=function a(c,e,g){u(this,a);this.body=c;this.params=e;this.args=g},Db=function(){function a(c){u(this,a);this.initialState=new Ab;this.resolutionVector=[];this.size=0;this.env=c}w(a,[{key:"accept",value:function(a,e){if(!this.env.syncLock)return new r("[RHO INTERNAL] can define rewrite rules only inside a _sync block");for(var c=[],f=this.initialState,k=a;k instanceof q;){f=f.accept(k.car,c);if(f instanceof r)return f;k=k.cdr}this.resolutionVector.push(new Bb(c,
e));f.makeFinal(this.size);this.size++;return!0}},{key:"find",value:function(a){for(var c=this.initialState,g=a,f=[];g instanceof q;){c=c.find(g.car,f);if(null===c)break;g=g.cdr}return null===c||null===c.finalPointer?null!==this.env.par?this.env.par.rho.find(a):[null,[]]:[this.resolutionVector[c.finalPointer],f]}},{key:"reduce",value:function(a,e){var c,f;f=this.find(a,void 0);c=f[0];if(null===c)return null;f=f[1];var k=[],h=!0,n=!1,p=void 0;try{for(var q=f[Symbol.iterator](),t;!(h=(t=q.next()).done);h=
!0){var r=t.value;r instanceof m?k.push(e.get(r)):k.push(r)}}catch(nb){n=!0,p=nb}finally{try{!h&&q["return"]&&q["return"]()}finally{if(n)throw p;}}return new Cb(c.body,c.params,k)}}]);return a}(),y=function(){function a(c,e,g){u(this,a);this.__itype__="env";this.map=new Map;this.par=g;this.syncLock=!0;this.bind(c,e);this.syncLock=!1;this.rho=new Db(this)}w(a,[{key:"sync",value:function(){this.syncLock=!0}},{key:"unsync",value:function(){this.syncLock=!1}},{key:"bind",value:function(a,e){if(!this.syncLock)return!1;
for(;a instanceof q;)A(e instanceof q,"can not bind a List to an Atom"),this.bind(a.car,e.car),a=a.cdr,e=e.cdr;null!==a&&(A(a instanceof m,""+a+" is not an IronSymbol"),this.map.set(a.symbol,e));return!0}},{key:"find",value:function(a){A(a instanceof m,""+a+" is not an IronSymbol");return this.map.has(a.symbol)?this:this.par.find(a)}},{key:"get",value:function(a){A(a instanceof m,""+a+" is not an IronSymbol");var c=a.symbol;a=this.map.has(c)?this.map.get(c):null!==this.par?this.par.get(a):a;return!(a instanceof
Function)&&a instanceof Object?Object.assign({},a):a}}]);return a}(),S=Math.max,ia="object"==typeof global&&global&&global.Object===Object&&global,Eb="object"==typeof self&&self&&self.Object===Object&&self,P=ia||Eb||Function("return this")(),C=P.Symbol,ja=Object.prototype,za=ja.hasOwnProperty,Aa=ja.toString,z=C?C.toStringTag:void 0,Ba=Object.prototype.toString,T=C?C.toStringTag:void 0,Q=P["__core-js_shared__"],ka=function(){var a=/[^.]+$/.exec(Q&&Q.keys&&Q.keys.IE_PROTO||"");return a?"Symbol(src)_1."+
a:""}(),Da=Function.prototype.toString,Fb=/^\[object .+?Constructor\]$/,Gb=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),la=function(){try{var a,c=null==Object?void 0:Object.defineProperty;a=(!U(c)||ka&&ka in c?0:(V(c)?Gb:Fb).test(Ca(c)))?c:void 0;a({},"",{});return a}catch(e){}}(),Hb=Date.now,Ea=function(a){var c=0,e=0;return function(){var g=Hb(),f=
16-(g-e);e=g;if(0<f){if(800<=++c)return arguments[0]}else c=0;return a.apply(void 0,arguments)}}(la?function(a,c){return la(a,"toString",{configurable:!0,enumerable:!1,value:ya(c),writable:!0})}:R),X=function(a){return t(function(c){var e=c.pop();a.call(this,c,e)})},I="function"===typeof Symbol&&Symbol.iterator,ma=Object.prototype,Ib=ma.hasOwnProperty,Jb=ma.propertyIsEnumerable,Ka=Z(function(){return arguments}())?Z:function(a){return H(a)&&Ib.call(a,"callee")&&!Jb.call(a,"callee")},Ja=Array.isArray,
na="object"==typeof exports&&exports&&!exports.nodeType&&exports,oa=na&&"object"==typeof module&&module&&!module.nodeType&&module,pa=oa&&oa.exports===na?P.Buffer:void 0,La=(pa?pa.isBuffer:void 0)||Fa,Oa=/^(?:0|[1-9]\d*)$/,n={};n["[object Float32Array]"]=n["[object Float64Array]"]=n["[object Int8Array]"]=n["[object Int16Array]"]=n["[object Int32Array]"]=n["[object Uint8Array]"]=n["[object Uint8ClampedArray]"]=n["[object Uint16Array]"]=n["[object Uint32Array]"]=!0;n["[object Arguments]"]=n["[object Array]"]=
n["[object ArrayBuffer]"]=n["[object Boolean]"]=n["[object DataView]"]=n["[object Date]"]=n["[object Error]"]=n["[object Function]"]=n["[object Map]"]=n["[object Number]"]=n["[object Object]"]=n["[object RegExp]"]=n["[object Set]"]=n["[object String]"]=n["[object WeakMap]"]=!1;var qa="object"==typeof exports&&exports&&!exports.nodeType&&exports,ra=qa&&"object"==typeof module&&module&&!module.nodeType&&module,sa=ra&&ra.exports===qa&&ia.process,D;a:{try{D=sa&&sa.binding("util");break a}catch(a){}D=
void 0}var ta=D&&D.isTypedArray,Ma=ta?Ha(ta):Ga,Na=Object.prototype.hasOwnProperty,Pa=Object.prototype,Ra=function(a,c){return function(e){return a(c(e))}}(Object.keys,Object),Qa=Object.prototype.hasOwnProperty,Wa={},Kb=K(ba,Infinity),Lb=function(a,c,e){(G(a)?Xa:Kb)(a,c,e)},Mb=function(a){return function(c,e,g){return a(Lb,c,e,g)}}(ca);W(Mb);var M=function(a){return function(c,e,g,f){return a(aa(e),c,g,f)}}(ca),Nb=K(M,1);W(Nb);t(function(a,c){return t(function(e){return a.apply(null,c.concat(e))})});
(function(a){return function(c,e,g){var f=-1,k=Object(c);g=g(c);for(var h=g.length;h--;){var m=g[a?h:++f];if(!1===e(k[m],m,k))break}return c}})();var ua="function"===typeof setImmediate&&setImmediate,va="object"===typeof process&&"function"===typeof process.nextTick;ea(ua?setImmediate:va?process.nextTick:da);v.prototype.removeLink=function(a){a.prev?a.prev.next=a.next:this.head=a.next;a.next?a.next.prev=a.prev:this.tail=a.prev;a.prev=a.next=null;--this.length;return a};v.prototype.empty=v;v.prototype.insertAfter=
function(a,c){c.prev=a;(c.next=a.next)?a.next.prev=c:this.tail=c;a.next=c;this.length+=1};v.prototype.insertBefore=function(a,c){c.prev=a.prev;c.next=a;a.prev?a.prev.next=c:this.head=c;a.prev=c;this.length+=1};v.prototype.unshift=function(a){this.head?this.insertBefore(this.head,a):(this.length=1,this.head=this.tail=a)};v.prototype.push=function(a){this.tail?this.insertAfter(this.tail,a):(this.length=1,this.head=this.tail=a)};v.prototype.shift=function(){return this.head&&this.removeLink(this.head)};
v.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)};var $a=K(ba,1),Ob=t(function(a){return t(function(c){var e=this,g=c[c.length-1];"function"==typeof g?c.pop():g=x;Za(a,c,function(a,c,g){c.apply(e,a.concat([t(function(a,c){g(a,c)})]))},function(a,c){g.apply(e,[a].concat(c))})})});t(function(a){return Ob.apply(null,a.reverse())});t(function(a){var c=[null].concat(a);return X(function(a,g){return g.apply(this,c)})});fa("dir");fa("log");var h=ea(va?process.nextTick:ua?setImmediate:
da),hb=new m("_quote"),ib=new m("_if"),jb=new m("_def"),kb=new m("_assign!"),pb=new m("_fn"),sb=new m("_begin"),rb=new m("_rho"),cb=new m("_self"),db=new m("_null_"),eb=new m("_{}_"),fb=new m("_[]_"),gb=new m("_map_"),lb=new m("_get"),mb=new m("_set"),ob=new m("_push"),tb=new m("_stream"),ub=new m("_do"),bb=function(a,c){if(a)throw a instanceof r&&a.log(),a;},Pb=function(){function a(c){u(this,a);this.pos=0;this.line=1;this.col=0;this.buffer=c.buffer;this.name=c.name}w(a,[{key:"next",value:function(){var a=
this.buffer.charAt(this.pos++);"\n"==a?(this.line++,this.col=0):this.col++;return a}},{key:"peek",value:function(){return this.buffer.charAt(this.pos)}},{key:"eof",value:function(){return""===this.peek()}},{key:"error",value:function(a){console.log(a+" @ "+this.name+" ("+this.line+":"+this.col+")");throw Error("Ironscript CompileTime Error");}}]);return a}(),E=function(){function a(c){u(this,a);this.source=new Pb(c);this.current=null}w(a,[{key:"readString",value:function(){for(var a="";!this.source.eof();){var e=
this.source.next();if("\\"==e)'"'==this.source.peek()?a+=this.source.next():"n"==this.source.peek()?(this.source.next(),a+="\n"):"t"==this.source.peek()?(this.source.next(),a+="\t"):a+=e;else if('"'==e)break;else a+=e}return a}},{key:"readSymbol",value:function(c){for(;!this.source.eof();){var e=this.source.peek();if(a.isOp(e)||a.isSpace(e)||'"'==e)break;c+=this.source.next()}return new m(c)}},{key:"readSpecial",value:function(a){for(var c="";!this.source.eof();){var g=this.source.next();if(g==a)if("@"==
this.source.peek()){this.source.next();break}else c+=g;else c+=g}return c}},{key:"readComment",value:function(){for(this.source.next();!this.source.eof()&&"\n"!==this.source.peek();)this.source.next()}},{key:"readNext",value:function(){for(;!this.source.eof()&&a.isSpace(this.source.peek());)this.source.next();if(this.source.eof())return null;var c=this.source.peek();if(";"==c)return this.readComment(),this.readNext();if(a.isOp(c))return this.source.next();if('"'==c)return this.source.next(),this.readString();
if("@"==c)if(c=this.source.next(),"{"==this.source.peek()){this.source.next();c=this.readSpecial("}");try{return xb(new Function("$return","$throw","$catch","$yield","$env","...args",c))}catch(e){throw console.error(c),e;}}else return"["==this.source.peek()?(this.source.next(),this.readSpecial("]")):this.readSymbol(c);else return c=this.readSymbol(""),isNaN(Number(c.symbol))?c:Number(c.symbol)}},{key:"next",value:function(){var a=this.current;this.current=null;return null===a?this.readNext():a}},
{key:"peek",value:function(){null===this.current&&(this.current=this.readNext());return this.current}},{key:"eof",value:function(){return null===this.peek()}},{key:"error",value:function(a){this.source.error(a+' near "'+this.current+'" ')}}],[{key:"isSpace",value:function(a){return 0<=" \t\n".indexOf(a)}},{key:"isOp",value:function(a){return/[\(\)\[\]\']/g.test(a)}},{key:"eps",get:function(){return""}}]);return a}(),N=function(){function a(c){u(this,a);this.lex=new E(c);this.root=this.parseList()}
w(a,[{key:"parse",value:function(){return this.root}},{key:"parseList",value:function(a){var c=this.parseAtom();if(c===a||c===E.eps)return null;for(var g=new q(c),f=g,c=this.parseAtom();c!==a&&c!==E.eps;)(")"===a&&"]"===c||"]"===a&&")"===c)&&this.error("Parenthesis/Bracket mismatch"),f.cdr=new q(c),f=f.cdr,c=this.parseAtom();return g}},{key:"parseAtom",value:function(){if(this.lex.eof())return E.eps;var a=this.lex.next();return"("===a?this.parseList(")"):"'"===a?q.cons(new m("_quote"),new q(this.parseAtom())):
"["===a?q.cons(new m("_self"),this.parseList("]")):a}},{key:"error",value:function(a){this.lex.error("[SYNTAX ERROR] "+a)}}]);return a}(),ha=function(){var a=new y(null,null,null);a.sync();a.bind(new m("_fx"),wb);a.bind(new m("_eval"),yb);a.bind(new m("_echo"),ga(zb));a.bind(new m("_new"),ga(function(a){for(var c=arguments.length,g=Array(1<c?c-1:0),f=1;f<c;f++)g[f-1]=arguments[f];return new (Function.prototype.bind.apply(a,[null].concat(g)))}));a.unsync();return a},Qb=function(a){var c=a.map.get("_readsource"),
e=new Map;return function(g,f,k,l){e.has(l)?h(k,null,f,null,e.get(l)):h(c,g,f,function(c,g,m,n){c=new N({name:l,buffer:n});h(p,c.parse(),a,function(a,c,g,m){e.set(l,c);h(k,null,f,null,c)})},l)}},Rb=function(){var a=ha();a.sync();a.bind(new m("_doc_"),document);a.bind(new m("_win_"),window);a.bind(new m("_readsource"),function(a,e,g,f){a=document.getElementById(f).text;h(g,null,e,null,a)});a.bind(new m("_import"),Qb(a));a.unsync();return a};document.addEventListener("DOMContentLoaded",function(){var a=
document.getElementById("ironscript-main").text,c="ironscript-main",e=Rb();c||(c="unnamed");a=new N({name:c,buffer:a});h(p,a.parse(),e)},!1)})();